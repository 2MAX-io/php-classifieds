<script type="text/javascript">
    let loadCustomFields = function() {
        let listingId = null | {{ listing.id | default('null') }};
        let categoryId = parseInt($('.formCategory').val());
        $.get(Routing.generate('app_listing_get_custom_fields', {listingId: listingId, categoryId: categoryId}), function (data) {
            $('.formCustomFieldsLoaded').remove();
            $(data).insertAfter('.formCustomFieldsHidden');
        });
    };

    loadCustomFields();

    $('.formCategory').on('change', function () {
        loadCustomFields();
    });
</script>
