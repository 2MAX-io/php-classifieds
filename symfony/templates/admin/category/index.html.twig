{% extends 'admin/base.html.twig' %}

{% block title %}{{ 'trans.Categories' | trans }}{% endblock %}

{% block body %}
    <div class="container mt-3">
        <div class="row mb-2">
            <div class="col-md-6">
                <h1>{{ 'trans.Categories' | trans }}</h1>
            </div>
            <div class="col-md-6 text-md-right">
                <a href="{{ path('app_admin_category_new') }}" class="btn btn-primary">{{ 'trans.Add category' | trans }}</a>
            </div>
        </div>

        <div class="list-group col nested-sortable mb-2" data-sortable-group="root">
            {# @var category1 \App\Entity\Category #}
            {% for category1 in categoryList %}
                <div class="list-group-item nested-1">
                    <div>
                        <div class="d-inline-block mb-3">{{ category1.name }}</div>
                        <a href="{{ path('app_admin_category_edit', {'id': category1.id}) }}" class="btn btn-primary">{{ 'trans.Edit' | trans }}</a>
                        <a href="{{ path('app_admin_category_new', {'parentCategory': category1.id}) }}" class="btn btn-success">{{ 'trans.Add subcategory' | trans }}</a>
                    </div>

                    <div class="list-group nested-sortable"  data-sortable-group="parent_{{ category1.id }}">
                    {% for category2 in category1.children  %}
                        <div class="list-group-item nested-2">
                            {{ category2.name }}
                            <a href="{{ path('app_admin_category_edit', {'id': category2.id}) }}" class="btn btn-primary">{{ 'trans.Edit' | trans }}</a>
                            <a href="{{ path('app_admin_category_new', {'parentCategory': category2.id}) }}" class="btn btn-success">{{ 'trans.Add subcategory' | trans }}</a>
                        </div>
                    {% endfor %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

{% endblock %}

{% block js %}
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-sortablejs@latest/jquery-sortable.js"></script>

    <script>
        $('.nested-sortable').each(function (i, el) {
            $(el).sortable({
                group: $(el).data('sortable-group'),
            });
        });
    </script>
{% endblock %}
