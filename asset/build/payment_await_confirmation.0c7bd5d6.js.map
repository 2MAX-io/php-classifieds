{"version":3,"sources":["webpack://symfony/./assets/public/payment/payment_await_confirmation.js"],"names":["paymentAwaitConfirmation","refresh","refreshCount","paymentAppToken","dataForJs","ParamEnum","$","ajax","Routing","type","dataType","data","done","text","$jsPaymentStatus","addClass","removeClass","Translator","window","location","href","refreshTimeout","setTimeout","fail","init"],"mappings":"uVAyDIA,EAA2B,I,0IAjDZ,G,6JAEf,WACIA,EAAyBC,Y,qBAG7B,WACID,EAAyBE,eACzB,IAAIC,EAAkBC,KAAUC,uBAChCC,EAAEC,KAAKC,aAAiB,6BAA8B,IAAK,CACvDC,KAAM,OACNC,SAAU,OACVC,KAAM,CACFR,gBAAiBA,KAGpBS,MAAK,SAAUD,GAGZ,GAFAL,EAAE,wBAAwBO,KAAKF,EAAI,kBAEH,IAA5BA,EAAI,gBAA8B,CAClC,IAAIG,EAAmBR,EAAE,sBACzBQ,EAAiBC,SAAS,gBAC1BD,EAAiBE,YAAY,eAC7BF,EAAiBD,KAAKI,UAAiB,kCAEvCC,OAAOC,SAASC,KAAOZ,aAAiB,0CAA2C,CAC/EL,gBAAiBA,QAElB,CACH,IAAIkB,EAAiB,IACjBrB,EAAyBE,aAAe,MACxCmB,EAAiB,KAEjBrB,EAAyBE,aAAe,OACxCmB,EAAiB,KAErBC,YAAW,WACPtB,EAAyBC,YAC1BoB,OAGVE,MAAK,WACFD,YAAW,WACPtB,EAAyBC,YAC1B,a,iCAMnBD,EAAyBwB,S","file":"payment_await_confirmation.0c7bd5d6.js","sourcesContent":["\"use strict\";\n\nimport dataForJs from \"~/function/dataForJs\";\nimport ParamEnum from \"~/enum/ParamEnum\";\nimport Routing from \"~/module/Routing\";\nimport Translator from \"~/module/Translator\";\n\nclass PaymentAwaitConfirmation {\n    refreshCount = 0;\n\n    init() {\n        paymentAwaitConfirmation.refresh();\n    }\n\n    refresh() {\n        paymentAwaitConfirmation.refreshCount++;\n        let paymentAppToken = dataForJs[ParamEnum.PAYMENT_APP_TOKEN];\n        $.ajax(Routing.generate(\"app_payment_status_refresh\", []), {\n            type: \"POST\",\n            dataType: \"json\",\n            data: {\n                paymentAppToken: paymentAppToken,\n            },\n        })\n            .done(function (data) {\n                $(\"#js__lastRefreshTime\").text(data[\"lastRefreshTime\"]);\n\n                if (data[\"paymentComplete\"] === true) {\n                    let $jsPaymentStatus = $(\"#js__paymentStatus\");\n                    $jsPaymentStatus.addClass(\"text-success\");\n                    $jsPaymentStatus.removeClass(\"text-danger\");\n                    $jsPaymentStatus.text(Translator.trans(\"trans.Success, redirecting...\"));\n\n                    window.location.href = Routing.generate(\"app_payment_await_confirmation_redirect\", {\n                        paymentAppToken: paymentAppToken,\n                    });\n                } else {\n                    let refreshTimeout = 800;\n                    if (paymentAwaitConfirmation.refreshCount > 300) {\n                        refreshTimeout = 5000;\n                    }\n                    if (paymentAwaitConfirmation.refreshCount > 1800) {\n                        refreshTimeout = 60 * 1000;\n                    }\n                    setTimeout(function () {\n                        paymentAwaitConfirmation.refresh();\n                    }, refreshTimeout);\n                }\n            })\n            .fail(function () {\n                setTimeout(function () {\n                    paymentAwaitConfirmation.refresh();\n                }, 5000);\n            });\n    }\n}\n\nlet paymentAwaitConfirmation = new PaymentAwaitConfirmation();\npaymentAwaitConfirmation.init();\n"],"sourceRoot":""}